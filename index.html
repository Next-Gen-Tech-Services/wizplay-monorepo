<!doctype html><html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Live Cricket Match</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0a1628 0%, #1a2f4f 100%);
        color: #e6eef8;
        padding: 20px;
        min-height: 100vh;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
      }

      @keyframes slideIn {
        from { transform: translateX(-20px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }

      .live-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        box-shadow: 0 4px 15px rgba(255, 68, 68, 0.4);
        animation: pulse 2s infinite;
      }

      .live-badge::before {
        content: '';
        width: 8px;
        height: 8px;
        background: white;
        border-radius: 50%;
        animation: pulse 1s infinite;
      }

      .match-header {
        background: linear-gradient(135deg, #1e3a5f 0%, #2d5a8e 100%);
        padding: 30px;
        border-radius: 20px;
        margin-bottom: 20px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        animation: fadeIn 0.6s ease;
        position: relative;
        overflow: hidden;
      }

      .match-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        animation: shimmer 3s infinite;
      }

      @keyframes shimmer {
        0% { left: -100%; }
        100% { left: 100%; }
      }

      .match-title {
        font-size: 28px;
        font-weight: 700;
        color: #fff;
        margin-bottom: 12px;
      }

      .match-meta {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
        color: #b0c4de;
        font-size: 14px;
      }

      .match-meta span {
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .score-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .team-score {
        background: linear-gradient(135deg, #1a2f4f 0%, #243d5c 100%);
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        animation: fadeIn 0.6s ease;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: 2px solid transparent;
      }

      .team-score:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4);
        border-color: #4a9eff;
      }

      .team-score.batting {
        border-color: #4ade80;
        background: linear-gradient(135deg, #1a3d2f 0%, #245c3d 100%);
      }

      .team-name {
        font-size: 18px;
        font-weight: 600;
        color: #b0c4de;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .score-display {
        font-size: 48px;
        font-weight: 700;
        color: #fff;
        margin-bottom: 8px;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .score-details {
        color: #8b9dc3;
        font-size: 14px;
      }

      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .tab {
        background: #1e3a5f;
        padding: 12px 24px;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        border: 2px solid transparent;
      }

      .tab:hover {
        background: #2d5a8e;
        transform: translateY(-2px);
      }

      .tab.active {
        background: linear-gradient(135deg, #4a9eff 0%, #357abd 100%);
        border-color: #6bb6ff;
        box-shadow: 0 4px 15px rgba(74, 158, 255, 0.4);
      }

      .content-card {
        background: linear-gradient(135deg, #1a2f4f 0%, #243d5c 100%);
        padding: 25px;
        border-radius: 16px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        margin-bottom: 20px;
        animation: fadeIn 0.6s ease;
      }

      .section-title {
        font-size: 20px;
        font-weight: 700;
        color: #fff;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .section-title::before {
        content: '';
        width: 4px;
        height: 24px;
        background: linear-gradient(180deg, #4a9eff 0%, #357abd 100%);
        border-radius: 2px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      thead {
        background: rgba(74, 158, 255, 0.1);
      }

      th {
        padding: 12px;
        text-align: left;
        font-weight: 600;
        color: #4a9eff;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      td {
        padding: 12px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        font-size: 14px;
        animation: slideIn 0.4s ease;
      }

      tbody tr:hover {
        background: rgba(74, 158, 255, 0.05);
      }

      .player-name {
        font-weight: 600;
        color: #fff;
      }

      .dismissal {
        color: #8b9dc3;
        font-size: 12px;
        font-style: italic;
      }

      .highlight {
        color: #4ade80;
        font-weight: 700;
      }

      .current-players {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
      }

      .player-card {
        background: linear-gradient(135deg, #2d4a6f 0%, #3a5a7f 100%);
        padding: 20px;
        border-radius: 12px;
        border-left: 4px solid #4ade80;
        animation: fadeIn 0.6s ease;
      }

      .player-card.bowler {
        border-left-color: #f59e0b;
      }

      .player-label {
        color: #8b9dc3;
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 8px;
      }

      .player-name-large {
        font-size: 18px;
        font-weight: 700;
        color: #fff;
        margin-bottom: 10px;
      }

      .player-stats {
        display: flex;
        gap: 15px;
        font-size: 14px;
        color: #b0c4de;
      }

      .stat {
        display: flex;
        flex-direction: column;
      }

      .stat-label {
        font-size: 11px;
        color: #8b9dc3;
      }

      .stat-value {
        font-size: 18px;
        font-weight: 700;
        color: #fff;
      }

      .recent-overs {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 15px;
      }

      .over-ball {
        min-width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #2d4a6f;
        border-radius: 8px;
        font-weight: 700;
        font-size: 14px;
        animation: fadeIn 0.3s ease;
        transition: transform 0.2s ease;
      }

      .over-ball:hover {
        transform: scale(1.1);
      }

      .over-ball.wicket {
        background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
        box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
      }

      .over-ball.boundary {
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        box-shadow: 0 4px 15px rgba(74, 222, 128, 0.4);
      }

      .over-ball.six {
        background: linear-gradient(135deg, #a855f7 0%, #7c3aed 100%);
        box-shadow: 0 4px 15px rgba(168, 85, 247, 0.4);
      }

      .partnership {
        background: rgba(74, 158, 255, 0.1);
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 10px;
        border-left: 3px solid #4a9eff;
      }

      .connection-status {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #1e3a5f;
        padding: 12px 20px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 13px;
        z-index: 1000;
      }

      .status-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #4ade80;
        animation: pulse 2s infinite;
      }

      .status-dot.disconnected {
        background: #ef4444;
      }

      .hidden {
        display: none !important;
      }

      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #8b9dc3;
      }

      .empty-state-icon {
        font-size: 48px;
        margin-bottom: 20px;
        opacity: 0.5;
      }

      @media (max-width: 768px) {
        .score-display {
          font-size: 36px;
        }
        .match-title {
          font-size: 22px;
        }
        .current-players {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <!-- Match Header -->
      <div class="match-header">
        <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 15px;">
          <div>
            <h1 class="match-title" id="matchTitle">Loading Match...</h1>
            <div class="match-meta" id="matchMeta">
              <span>üìç <span id="venue">‚Äî</span></span>
              <span>üèÜ <span id="tournament">‚Äî</span></span>
              <span>‚è∞ <span id="startTime">‚Äî</span></span>
            </div>
          </div>
          <div class="live-badge" id="liveBadge" style="display: none;">Live</div>
        </div>
      </div>

      <!-- Scores -->
      <div class="score-section" id="scoreSection"></div>

      <!-- Current Players (Live Only) -->
      <div id="currentPlayersSection" class="hidden">
        <div class="content-card">
          <h2 class="section-title">At The Crease</h2>
          <div class="current-players" id="currentPlayers"></div>
          
          <h3 class="section-title" style="margin-top: 25px;">Recent Balls</h3>
          <div class="recent-overs" id="recentBalls"></div>
        </div>
      </div>

      <!-- Tabs -->
      <div class="tabs">
        <div class="tab active" onclick="switchTab('scorecard')">Scorecard</div>
        <div class="tab" onclick="switchTab('partnerships')">Partnerships</div>
        <div class="tab" onclick="switchTab('fow')">Fall of Wickets</div>
      </div>

      <!-- Tab Content -->
      <div id="scorecardTab" class="content-card">
        <div id="inningsContainer"></div>
      </div>

      <div id="partnershipsTab" class="content-card hidden">
        <h2 class="section-title">Partnerships</h2>
        <div id="partnershipsContainer"></div>
      </div>

      <div id="fowTab" class="content-card hidden">
        <h2 class="section-title">Fall of Wickets</h2>
        <div id="fowContainer"></div>
      </div>

      <!-- Connection Status -->
      <div class="connection-status">
        <div class="status-dot" id="statusDot"></div>
        <span id="statusText">Connecting...</span>
      </div>
    </div>

    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
      const HOST = "https://46e2de1f5d58.ngrok-free.app";
      const matchId = "a-rz--cricket--qL1949026769805914118";
      let currentData = null;

      // Tab switching
      function switchTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
        
        document.getElementById('scorecardTab').classList.add('hidden');
        document.getElementById('partnershipsTab').classList.add('hidden');
        document.getElementById('fowTab').classList.add('hidden');
        
        document.getElementById(tab + 'Tab').classList.remove('hidden');
      }

      // Update UI with transformed data
      function updateUI(data) {
        currentData = data;
        
        // Match header
        document.getElementById('matchTitle').textContent = data.match.title;
        document.getElementById('venue').textContent = `${data.match.venue.name}, ${data.match.venue.city}`;
        document.getElementById('tournament').textContent = data.match.tournament.name;
        document.getElementById('startTime').textContent = new Date(data.match.startTime.epoch * 1000).toLocaleString();
        
        // Show live badge
        if (data.live) {
          document.getElementById('liveBadge').style.display = 'inline-flex';
        }

        // Scores
        const scoreSection = document.getElementById('scoreSection');
        scoreSection.innerHTML = '';
        
        data.innings.forEach(inn => {
          const isBatting = data.live && data.live.battingTeam === inn.teamName;
          const scoreCard = document.createElement('div');
          scoreCard.className = `team-score ${isBatting ? 'batting' : ''}`;
          scoreCard.innerHTML = `
            <div class="team-name">
              ${inn.teamName} ${inn.teamCode ? `(${inn.teamCode})` : ''}
              ${isBatting ? '<span class="live-badge" style="font-size: 10px; padding: 4px 10px;">BATTING</span>' : ''}
            </div>
            <div class="score-display">${inn.score.runs}/${inn.score.wickets}</div>
            <div class="score-details">
              Overs: ${inn.score.overs} ‚Ä¢ RR: ${inn.score.runRate.toFixed(2)} ‚Ä¢ Extras: ${inn.score.extras}
            </div>
          `;
          scoreSection.appendChild(scoreCard);
        });

        // Current players (if live)
        if (data.live) {
          document.getElementById('currentPlayersSection').classList.remove('hidden');
          
          const currentPlayers = document.getElementById('currentPlayers');
          currentPlayers.innerHTML = `
            <div class="player-card">
              <div class="player-label">Striker</div>
              <div class="player-name-large">${data.live.striker.name}</div>
              <div class="player-stats">
                <div class="stat">
                  <span class="stat-label">Runs</span>
                  <span class="stat-value">${data.live.striker.runs}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Balls</span>
                  <span class="stat-value">${data.live.striker.balls}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">SR</span>
                  <span class="stat-value">${data.live.striker.strikeRate.toFixed(1)}</span>
                </div>
              </div>
            </div>
            <div class="player-card">
              <div class="player-label">Non-Striker</div>
              <div class="player-name-large">${data.live.nonStriker.name}</div>
              <div class="player-stats">
                <div class="stat">
                  <span class="stat-label">Runs</span>
                  <span class="stat-value">${data.live.nonStriker.runs}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Balls</span>
                  <span class="stat-value">${data.live.nonStriker.balls}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">SR</span>
                  <span class="stat-value">${data.live.nonStriker.strikeRate.toFixed(1)}</span>
                </div>
              </div>
            </div>
            <div class="player-card bowler">
              <div class="player-label">Bowler</div>
              <div class="player-name-large">${data.live.bowler.name}</div>
              <div class="player-stats">
                <div class="stat">
                  <span class="stat-label">Overs</span>
                  <span class="stat-value">${data.live.bowler.overs}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Wickets</span>
                  <span class="stat-value">${data.live.bowler.wickets}</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Eco</span>
                  <span class="stat-value">${data.live.bowler.economy.toFixed(2)}</span>
                </div>
              </div>
            </div>
          `;

          // Recent balls
          const recentBalls = document.getElementById('recentBalls');
          recentBalls.innerHTML = '';
          
          if (data.live.recentOvers.length > 0) {
            const latestOver = data.live.recentOvers[data.live.recentOvers.length - 1];
            latestOver.ballDetails.forEach(ball => {
              const ballDiv = document.createElement('div');
              ballDiv.className = 'over-ball';
              if (ball.isWicket) ballDiv.classList.add('wicket');
              else if (ball.runs === 4) ballDiv.classList.add('boundary');
              else if (ball.runs === 6) ballDiv.classList.add('six');
              ballDiv.textContent = ball.repr;
              recentBalls.appendChild(ballDiv);
            });
          }
        } else {
          document.getElementById('currentPlayersSection').classList.add('hidden');
        }

        // Scorecard
        renderScorecard(data);
        renderPartnerships(data);
        renderFallOfWickets(data);
      }

      function renderScorecard(data) {
        const container = document.getElementById('inningsContainer');
        container.innerHTML = '';

        data.innings.forEach(inn => {
          const inningsDiv = document.createElement('div');
          inningsDiv.style.marginBottom = '40px';
          
          inningsDiv.innerHTML = `
            <h3 class="section-title">${inn.teamName} - Innings ${inn.innings_number}</h3>
            
            <h4 style="color: #4a9eff; margin: 20px 0 10px 0; font-size: 16px;">Batting</h4>
            <table>
              <thead>
                <tr>
                  <th>Batsman</th>
                  <th>R</th>
                  <th>B</th>
                  <th>4s</th>
                  <th>6s</th>
                  <th>SR</th>
                </tr>
              </thead>
              <tbody>
                ${inn.batting.map(bat => `
                  <tr>
                    <td>
                      <div class="player-name">${bat.name}</div>
                      ${bat.dismissal ? `<div class="dismissal">${bat.dismissal}</div>` : ''}
                    </td>
                    <td class="highlight">${bat.runs}</td>
                    <td>${bat.balls}</td>
                    <td>${bat.fours}</td>
                    <td>${bat.sixes}</td>
                    <td>${bat.strikeRate.toFixed(1)}</td>
                  </tr>
                `).join('')}
                <tr style="font-weight: 700; background: rgba(74, 158, 255, 0.1);">
                  <td>Extras</td>
                  <td class="highlight">${inn.score.extras}</td>
                  <td colspan="4" style="color: #8b9dc3; font-size: 12px;">
                    ${data.extras[inn.id] ? `b ${data.extras[inn.id].byes}, lb ${data.extras[inn.id].legByes}, wd ${data.extras[inn.id].wides}, nb ${data.extras[inn.id].noBalls}` : ''}
                  </td>
                </tr>
                <tr style="font-weight: 700; background: rgba(74, 158, 255, 0.15);">
                  <td>Total</td>
                  <td class="highlight">${inn.score.runs}</td>
                  <td>${inn.score.wickets} wkts</td>
                  <td colspan="3">${inn.score.overs} overs</td>
                </tr>
              </tbody>
            </table>

            <h4 style="color: #4a9eff; margin: 25px 0 10px 0; font-size: 16px;">Bowling</h4>
            <table>
              <thead>
                <tr>
                  <th>Bowler</th>
                  <th>O</th>
                  <th>M</th>
                  <th>R</th>
                  <th>W</th>
                  <th>Econ</th>
                </tr>
              </thead>
              <tbody>
                ${inn.bowling.map(bowl => `
                  <tr>
                    <td class="player-name">${bowl.name}</td>
                    <td>${bowl.overs}</td>
                    <td>${bowl.maidens}</td>
                    <td>${bowl.runs}</td>
                    <td class="highlight">${bowl.wickets}</td>
                    <td>${bowl.economy.toFixed(2)}</td>
                  </tr>
                `).join('')}
              </tbody>
            </table>
          `;
          
          container.appendChild(inningsDiv);
        });
      }

      function renderPartnerships(data) {
        const container = document.getElementById('partnershipsContainer');
        container.innerHTML = '';

        data.innings.forEach(inn => {
          if (inn.partnerships.length === 0) return;
          
          const section = document.createElement('div');
          section.style.marginBottom = '30px';
          section.innerHTML = `<h3 class="section-title">${inn.teamName}</h3>`;
          
          inn.partnerships.forEach(p => {
            const partDiv = document.createElement('div');
            partDiv.className = 'partnership';
            partDiv.innerHTML = `
              <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <div>
                  <strong>${p.player1.name}</strong> (${p.player1.runs} runs, ${p.player1.balls} balls) & 
                  <strong>${p.player2.name}</strong> (${p.player2.runs} runs, ${p.player2.balls} balls)
                </div>
                <div style="font-size: 20px; font-weight: 700; color: #4a9eff;">
                  ${p.runs} runs (${p.balls} balls)
                </div>
              </div>
              <div style="margin-top: 8px; color: #8b9dc3; font-size: 13px;">
                Run Rate: ${p.runRate.toFixed(2)} ${p.completed ? '‚Ä¢ Completed' : '‚Ä¢ Current'}
              </div>
            `;
            section.appendChild(partDiv);
          });
          
          container.appendChild(section);
        });

        if (container.innerHTML === '') {
          container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üìä</div><p>No partnership data available</p></div>';
        }
      }

      function renderFallOfWickets(data) {
        const container = document.getElementById('fowContainer');
        
        if (data.fallOfWickets.length === 0) {
          container.innerHTML = '<div class="empty-state"><div class="empty-state-icon">üèè</div><p>No wickets fallen yet</p></div>';
          return;
        }

        container.innerHTML = `
          <table>
            <thead>
              <tr>
                <th>#</th>
                <th>Player Out</th>
                <th>Score</th>
                <th>Overs</th>
                <th>Dismissal</th>
              </tr>
            </thead>
            <tbody>
              ${data.fallOfWickets.map(fow => `
                <tr>
                  <td class="highlight">${fow.wicketNumber}</td>
                  <td class="player-name">${fow.playerOut}</td>
                  <td>${fow.runs}</td>
                  <td>${fow.overs}</td>
                  <td class="dismissal">${fow.dismissal}</td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        `;
      }

      // Connection handling
      function setStatus(text, connected) {
        document.getElementById('statusText').textContent = text;
        const dot = document.getElementById('statusDot');
        if (connected) {
          dot.classList.remove('disconnected');
        } else {
          dot.classList.add('disconnected');
        }
      }

      // Socket.IO connection
      const socket = io(HOST, {
        path: "/socket.io",
        transports: ["polling", "websocket"],
        reconnection: true,
        reconnectionAttempts: 5,
      });

      socket.on("connect", () => {
        setStatus("Connected", true);
        socket.emit("join", matchId);
      });

      socket.on("disconnect", () => {
        setStatus("Disconnected", false);
      });

      socket.on("match_update", (payload) => {
        // Transform the raw payload using the backend transformer logic
        // For demo purposes, assuming payload is already transformed
        // In production, you'd call transformCricketMatch(payload) here
        updateUI(payload);
      });

      socket.on("live_update", (payload) => {
        updateUI(payload);
      });

      socket.on("connect_error", () => {
        setStatus("Connection Error", false);
      });
    </script>
  </body>
</html>